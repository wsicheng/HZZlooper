#ifndef HZZLOOPER_UTILITIES_H
#define HZZLOOPER_UTILITIES_H

#include "TMath.h"
#include "TH1.h"
#include "TH2.h"
#include "TH3.h"
#include "TGraph.h"
#include "TCanvas.h"
#include "TFile.h"

#include <map>
#include <string>

namespace {

// Histogram manipulation
inline void moveOverFlowToLastBin1D(TH1* hist) {
  int nbin = hist->GetNbinsX();
  if (hist->GetBinLowEdge(nbin+1) < 1499.9) return;  // only when the last bin is the infinity bin
  if (hist->GetBinContent(nbin+1) > 0) {
    // cout << "Moving the overflow for hist: " << hist->GetTitle() << " to its last bin!" << endl;
    double err = 0;
    hist->SetBinContent(nbin, hist->IntegralAndError(nbin, -1, err));
    hist->SetBinError(nbin, err);
    hist->SetBinContent(nbin+1, 0);
    hist->SetBinError(nbin+1, 0);
  }
}

inline void moveXOverFlowToLastBin3D(TH3* hist) {
  int nbinx = hist->GetNbinsX();
  if (hist->GetXaxis()->GetBinLowEdge(nbinx+1) < 1499.9) return; // only when the last bin is infinity
  for (int ibiny = 0; ibiny < hist->GetNbinsY(); ++ibiny) {
    for (int ibinz = 0; ibinz < hist->GetNbinsZ(); ++ibinz) {
      if (hist->GetBinContent(nbinx+1, ibiny, ibinz) <= 0) continue;
      double err = 0;
      double yield = hist->IntegralAndError(nbinx, -1, ibiny, ibiny, ibinz, ibinz, err);
      hist->SetBinContent(nbinx, ibiny, ibinz, yield);
      hist->SetBinError(nbinx, ibiny, ibinz, err);
      hist->SetBinContent(nbinx+1, ibiny, ibinz, 0);
      hist->SetBinError(nbinx+1, ibiny, ibinz, 0);
    }
  }
}

inline void zeroOutNegativeYields(TH1* hist) {
  int nbin = hist->GetNbinsX();
  for (int ibin = 1; ibin <= nbin; ++ibin) {
    if (hist->GetBinContent(ibin) < 0) {
      if (string(hist->GetName()).find("h_metbins_") == string::npos)  // only print out for central hist
        cout << "Reverting negative yield " << hist->GetBinContent(ibin) << " in: " << hist->GetTitle() << " bin " << ibin << " to 0!" << endl;
      hist->SetBinContent(ibin, 0);
      // hist->SetBinError(ibin, 0); // should we set the error to 0 also?
    }
  }
}

inline void conditionalizeHist(TH2* h2d, bool invert = false) {
  int nbinsX = h2d->GetNbinsX();
  int nbinsY = h2d->GetNbinsY();
  for (int ybin = 1; ybin <= nbinsY; ++ybin) {
    double xint = h2d->Integral(1,nbinsX, ybin, ybin);
    for (int xbin = 1; xbin <= nbinsX; ++xbin) {
      double bcorg = h2d->GetBinContent(xbin,ybin);
      h2d->SetBinContent(xbin, ybin, bcorg / xint);
    }
  }
}

// Quick helper functions
inline float deltaPhi(float phi1, float phi2) {
  float dphi = fabs(phi1 - phi2);
  if (dphi > TMath::Pi()) dphi = TMath::TwoPi() - dphi;
  return dphi;
}

inline float min2deltaPhi(float phi0, float phi1, float phi2) {
  return std::min(deltaPhi(phi0, phi1), deltaPhi(phi0, phi2));
}

inline float calculateMT(double Et1, double phi1, double Et2, double phi2) {
  return sqrt(2*Et1*Et2*(1.0 - cos(phi1-phi2)));
}

inline bool isCloseObject(const float eta1, const float phi1, const float eta2, const float phi2, const float conesize = 0.4, float* deltaR = nullptr) {
  const float PI = TMath::Pi();
  float deltaEta = fabs(eta1 - eta2);
  if (deltaEta > conesize) return false;
  float deltaPhi = fabs(phi1 - phi2);
  if (deltaPhi > PI) deltaPhi = 2*PI - deltaPhi;
  if (deltaPhi > conesize) return false;
  float deltaR2 = deltaEta*deltaEta + deltaPhi*deltaPhi;
  if (deltaR2 > conesize*conesize) return false;
  if (deltaR) *deltaR = sqrt(deltaR2);

  return true;
}

// Old functions that enforce float for ranges to be consistent with xval for floating point errors
void plot1D(string name, float xval, double weight, std::map<string, TH1*> &allhistos, string title, int numbinsx, float xmin, float xmax)
{
  if (title=="") title=name;
  std::map<string, TH1*>::iterator iter= allhistos.find(name);
  if (iter == allhistos.end()) { //no histo for this yet, so make a new one
    TH1D* currentHisto= new TH1D(name.c_str(), title.c_str(), numbinsx, xmin, xmax);
    currentHisto->SetDirectory(0);
    currentHisto->Sumw2();
    currentHisto->Fill(xval, weight);
    allhistos.insert(std::pair<string, TH1*>(name, currentHisto) );
  } else {
    iter->second->Fill(xval, weight);
  }
}

void linkHist(string hnew, string hexist, std::map<std::string, TH1*> &allhistos)
{
  // Could be useful when mutiple ratio hists sharing a common denominator
  if (allhistos.count(hnew)) return;
  auto iter = allhistos.find(hexist);
  if (iter == allhistos.end()) throw std::logic_error("linkHist(): Histogram "+hexist+" need to be plotted first");
  allhistos.insert( std::pair<std::string, TH1*>(hnew, iter->second) );
}


// Templated function
template<class LorentzVectorType>
inline float calculateMt(const LorentzVectorType& l1p4, const LorentzVectorType& l2p4, double met, double met_phi){
  LorentzVectorType zp4 = l1p4 + l2p4;
  float phi1 = zp4.Phi();
  float phi2 = met_phi;
  float Et1  = zp4.Et();
  float Et2  = met;

  return sqrt(2*Et1*Et2*(1.0 - cos(phi1-phi2)));
}

template<class LorentzVectorType>
inline float getDileptonMT(const LorentzVectorType& boson, const LorentzVectorType& metvec) {
  double ptll = boson.Pt(), mll = boson.M(), met = metvec.Pt();
  double term1 = sqrt(ptll*ptll + mll*mll) + sqrt(met*met + 91.2*91.2);
  double term2 = (boson + metvec).Pt();
  return sqrt( term1*term1 - term2*term2 );
}


template<class LorentzVectorType>
bool isCloseObject(const LorentzVectorType& p1, const LorentzVectorType& p2, const float conesize = 0.4, float* deltaR = nullptr)
{
  const float PI = TMath::Pi();
  float deltaEta = fabs(p1.Eta() - p2.Eta());
  if (deltaEta > conesize) return false;
  float deltaPhi = fabs(p1.Phi() - p2.Phi());
  if (deltaPhi > PI) deltaPhi = 2*PI - deltaPhi;
  if (deltaPhi > conesize) return false;
  float deltaR2 = deltaEta*deltaEta + deltaPhi*deltaPhi;
  if (deltaR2 > conesize*conesize) return false;
  if (deltaR) *deltaR = sqrt(deltaR2);

  return true;
}

template<typename... TArgs>
void plot1d(std::string name, double xval, double weight, std::map<std::string, TH1*> &allhistos, TArgs... args)
{
  auto iter = allhistos.find(name);
  if (iter == allhistos.end()) {
    TH1D* currentHisto= new TH1D(name.c_str(), args...);
    currentHisto->SetDirectory(0);
    currentHisto->Sumw2();
    currentHisto->Fill(xval, weight);
    allhistos.insert( std::pair<std::string, TH1*>(name, currentHisto) );
  } else {
    iter->second->Fill(xval, weight);
  }
}

template<typename... TArgs>
void plot2d(std::string name, double xval, double yval, double weight, std::map<std::string, TH1*> &allhistos, TArgs... args)
{
  auto iter = allhistos.find(name);
  if (iter == allhistos.end()) {
    TH2D* currentHisto= new TH2D(name.c_str(), args...);
    currentHisto->SetDirectory(0);
    currentHisto->Sumw2();
    currentHisto->Fill(xval, yval, weight);
    allhistos.insert( std::pair<std::string, TH1*>(name, currentHisto) );
  } else {
    ((TH2D*) iter->second)->Fill(xval, yval, weight);
  }
}

template<typename... TArgs>
void plot3d(std::string name, double xval, double yval, double zval, double weight, std::map<std::string, TH1*> &allhistos, TArgs... args)
{
  auto iter = allhistos.find(name);
  if (iter == allhistos.end()) {
    TH3D* currentHisto= new TH3D(name.c_str(), args...);
    currentHisto->SetDirectory(0);
    currentHisto->Sumw2();
    currentHisto->Fill(xval, yval, zval, weight);
    allhistos.insert( std::pair<std::string, TH1*>(name, currentHisto) );
  } else {
    ((TH3D*) iter->second)->Fill(xval, yval, zval, weight);
  }
}

// Constants 

const vector<float> ptRanges = {
  55, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290,
  300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 7000
};
const vector<float> ptScales_geq1j = {
  0.2624, 0.4459, 1.0055, 1.5919, 2.0895, 2.5699, 3.0485, 3.5010, 3.8843, 4.2915, 4.6683, 5.1468, 5.4683, 5.7617, 5.9639,
  6.2891, 6.4758, 6.8194, 7.1370, 7.5179, 7.8242, 7.8640, 8.1332, 8.7345, 8.5413, 8.9472, 9.5241, 9.6099, 9.5511, 9.9231,
  9.8243, 10.152, 10.586, 10.708, 9.7402, 9.3267, 10.357, 10.338, 11.061, 12.649
}; // Zpeak scales

// const vector<float> ZptScales_metlt125_geq1j = {
//   0.3227,0.5098,1.0280,1.5541,2.0717,2.5576,2.8921,3.3705,3.8081,4.0251,4.4906,5.0358,5.3964,5.8257,5.8401,6.3287,6.3288,7.0088,7.3222,7.6697,8.4301,8.8464,
//   8.3650,9.6479,9.3350,10.303,10.806,12.325,13.306,11.829,11.806,11.935,13.628,15.315,11.767,12.058,14.328,14.386,14.599,19.509
// };


/// skimsamp scales, fullmet actually
// const vector<float> ZptScales_metlt125_eq0j = {0.073,0.077,0.083,0.103,0.153,0.143,0.243,0.146,0.211,0.153,0.587,0.691,0.112,1.000,0.753,0.132,0.020,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.223,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,};
// const vector<float> ZptScales_metlt125_eq1j = {0.057,0.080,0.104,0.137,0.141,0.191,0.195,0.210,0.262,0.262,0.263,0.265,0.263,0.382,0.256,0.302,0.334,0.380,0.340,0.467,0.202,0.489,0.401,0.402,0.450,0.318,0.123,0.432,1.129,0.259,0.392,0.349,0.201,0.087,0.882,0.001,0.516,0.450,0.193,0.437,1.000,1.000,1.000,};
// const vector<float> ZptScales_metlt125_eq2j = {0.022,0.029,0.046,0.054,0.070,0.097,0.112,0.123,0.137,0.158,0.143,0.176,0.185,0.213,0.152,0.275,0.271,0.220,0.248,0.194,0.237,0.283,0.303,0.170,0.193,0.122,0.281,0.208,0.646,0.290,0.451,0.173,0.301,0.547,0.445,0.153,0.340,0.386,0.566,0.160,1.000,1.000,1.000,};

/// skimsamp scales, tight photon
// const vector<float> ZptScales_metlt125_eq0j = {0.050,0.052,0.058,0.077,0.122,0.154,0.322,0.224,0.230,0.247,0.717,0.713,0.215,1.000,0.589,0.155,0.030,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.223,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,};
// const vector<float> ZptScales_metlt125_eq1j = {0.047,0.065,0.079,0.109,0.118,0.202,0.248,0.273,0.345,0.366,0.351,0.364,0.327,0.491,0.365,0.411,0.467,0.495,0.425,0.638,0.269,0.678,0.546,0.560,0.583,0.425,0.169,0.599,1.369,0.275,0.528,0.478,0.298,0.131,1.084,0.001,0.759,0.687,0.293,0.613,1.000,1.000,};
// const vector<float> ZptScales_metlt125_eq2j = {0.050,0.066,0.101,0.113,0.146,0.201,0.235,0.258,0.284,0.352,0.299,0.333,0.394,0.445,0.301,0.566,0.540,0.465,0.536,0.390,0.475,0.539,0.590,0.332,0.367,0.239,0.526,0.357,1.420,0.616,0.770,0.349,0.566,0.920,0.897,0.241,0.552,0.853,0.871,0.267,1.000,1.000,};

/// skimsamp scales, barrel tight photon
const vector<float> ZptScales_metlt125_eq0j = {0.140,0.156,0.179,0.213,0.296,0.307,0.366,0.635,0.529,0.585,1.319,1.323,0.501,1.020,3.260,7.808,0.213,0.435,1.000,1.000,1.000,1.611,1.000,1.000,1.817,1.000,1.341,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,};
const vector<float> ZptScales_metlt125_eq1j = {0.131,0.164,0.205,0.247,0.298,0.344,0.371,0.416,0.436,0.433,0.483,0.518,0.480,0.600,0.585,0.526,0.599,0.552,0.589,0.717,0.536,0.606,0.571,0.721,0.553,0.450,0.397,0.697,0.723,0.882,0.899,0.386,0.329,0.397,0.485,0.647,1.225,0.546,1.079,0.574,1.000,1.000,};
const vector<float> ZptScales_metlt125_eq2j = {0.100,0.125,0.169,0.209,0.248,0.294,0.336,0.380,0.430,0.449,0.463,0.415,0.515,0.576,0.579,0.615,0.676,0.715,0.608,0.618,0.784,0.523,0.444,0.482,0.779,0.452,0.462,0.627,0.657,0.484,0.642,0.270,0.641,0.771,1.034,0.567,0.565,0.371,0.161,0.525,1.000,1.000,};

const vector<float> ZptScales_met50to125_eq0j = {0.144,0.152,0.160,0.204,0.322,0.425,0.472,0.317,0.384,0.338,0.802,0.844,1.141,1.000,0.589,0.756,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,};
const vector<float> ZptScales_met50to125_eq1j = {0.121,0.172,0.207,0.259,0.275,0.352,0.375,0.426,0.458,0.587,0.548,0.517,0.471,0.779,0.546,0.545,0.611,0.580,0.573,0.874,0.364,1.076,0.651,0.687,0.618,0.595,0.280,0.797,1.797,0.490,0.565,0.498,0.279,0.206,1.533,0.040,0.898,1.245,0.475,0.683,1.000,1.000,};
const vector<float> ZptScales_met50to125_eq2j = {0.105,0.128,0.172,0.208,0.250,0.295,0.376,0.394,0.442,0.463,0.466,0.439,0.534,0.542,0.442,0.621,0.818,0.578,0.743,0.451,0.540,0.725,1.004,0.507,0.325,0.258,0.849,0.515,1.825,0.647,1.237,0.524,0.842,0.840,1.420,0.492,0.327,0.415,0.947,0.105,1.000,1.000,};

vector<float> sf_Vpt_allbkg_metlt80_eq0j  = {1.845e-02,8.454e-03,2.593e-02,2.279e-02,2.647e-02,3.508e-02,1.312e-02,3.422e-02,1.967e-02,1.698e-02,1.107e-02,7.435e-03,3.808e-02,1.408e-02,1.954e-04,1.000e+00,3.002e-05,7.189e-04,3.427e-02,9.150e-01,1.272e-03,1.113e-03,2.319e-04,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_allbkg_metlt80_eq1j  = {1.680e-02,2.142e-02,2.802e-02,3.373e-02,3.791e-02,4.324e-02,4.942e-02,5.232e-02,5.951e-02,6.183e-02,6.399e-02,6.656e-02,7.454e-02,6.727e-02,7.755e-02,5.231e-02,8.793e-02,8.247e-02,7.848e-02,7.623e-02,8.040e-02,7.320e-02,6.604e-02,5.754e-02,7.805e-02,1.143e-01,5.071e-02,1.091e-01,1.175e-01,1.181e-01,1.015e-01,2.629e-01,1.180e-01,1.180e-01,7.835e-03,1.000e+00,8.876e-02,1.035e-01,2.168e-01,8.095e-02,1.000e+00,1.000e+00,1.545e-01,6.165e-02,1.507e-02,1.000e+00,1.014e-03,8.514e-01,1.419e-01,8.622e-02,1.031e-01,1.766e-01,1.000e+00,2.121e-01,2.281e-01,};
vector<float> sf_Vpt_allbkg_metlt80_eq2j  = {1.254e-02,1.567e-02,2.025e-02,2.843e-02,2.985e-02,3.841e-02,4.065e-02,4.851e-02,4.710e-02,5.875e-02,6.080e-02,7.860e-02,6.877e-02,5.523e-02,6.168e-02,6.086e-02,7.655e-02,7.825e-02,6.608e-02,9.100e-02,5.355e-02,1.003e-01,6.197e-02,9.371e-02,6.870e-02,1.130e-01,8.065e-02,1.029e-01,1.273e-01,8.087e-02,1.028e-01,5.363e-02,1.856e-01,4.622e-02,2.297e-01,1.673e-01,3.960e-01,2.558e-01,5.644e-01,6.793e-02,3.463e-01,6.684e-02,1.000e+00,1.395e-01,3.518e-02,2.737e-01,1.000e+00,7.010e-02,1.370e+00,2.972e-01,1.000e+00,3.544e-01,1.000e+00,4.505e-03,1.457e-01,};
vector<float> sf_Vpt_allbkg_metlt125_eq0j = {1.841e-02,8.598e-03,2.689e-02,2.501e-02,3.153e-02,4.382e-02,1.840e-02,4.869e-02,3.829e-02,3.059e-02,2.140e-02,1.559e-02,3.746e-02,1.597e-02,2.051e-04,1.000e+00,1.061e-03,1.708e-03,3.440e-02,3.177e-01,1.136e-03,1.108e-03,1.530e-04,1.000e+00,7.327e+00,1.000e+00,1.692e-03,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_allbkg_metlt125_eq1j = {1.687e-02,2.156e-02,2.821e-02,3.404e-02,3.837e-02,4.357e-02,4.993e-02,5.294e-02,6.021e-02,6.204e-02,6.444e-02,6.680e-02,7.505e-02,6.815e-02,3.657e-02,5.201e-02,8.713e-02,8.233e-02,7.564e-02,7.690e-02,8.149e-02,7.363e-02,7.017e-02,6.031e-02,7.531e-02,1.127e-01,5.225e-02,1.065e-01,1.146e-01,1.096e-01,1.154e-01,2.807e-01,1.186e-01,1.310e-01,7.794e-03,2.017e-02,7.692e-02,1.036e-01,2.227e-01,8.137e-02,1.000e+00,1.000e+00,1.552e-01,4.774e-02,1.506e-02,1.000e+00,1.013e-03,8.512e-01,1.419e-01,8.758e-02,1.033e-01,1.766e-01,1.000e+00,2.120e-01,2.478e-01,};
vector<float> sf_Vpt_allbkg_metlt125_eq2j = {1.261e-02,1.585e-02,2.050e-02,2.858e-02,3.031e-02,3.857e-02,4.073e-02,4.909e-02,4.765e-02,5.970e-02,6.077e-02,7.874e-02,6.975e-02,5.741e-02,6.262e-02,5.904e-02,7.573e-02,8.063e-02,6.595e-02,8.743e-02,5.829e-02,9.744e-02,6.785e-02,9.083e-02,8.242e-02,1.078e-01,8.594e-02,1.091e-01,1.214e-01,8.054e-02,9.992e-02,6.321e-02,1.718e-01,6.847e-02,2.143e-01,1.846e-01,3.342e-01,2.747e-01,4.825e-01,6.487e-02,3.142e-01,3.398e-02,1.000e+00,1.399e-01,3.567e-02,2.477e-01,1.000e+00,6.665e-02,1.367e+00,2.970e-01,9.967e-03,2.926e-01,1.000e+00,2.902e-03,1.826e-01,};

// // With endcap photon

// vector<float> sf_Vpt_closure_metlt80_eq0j  = {2.104e-2,2.224e-2,2.529e-2,2.517e-2,2.287e-2,3.051e-2,2.673e-2,2.867e-2,1.366e-2,1.379e-2,9.551e-3,4.982e-3,3.615e-2,1.422e-2,6.765e-2,1.000000,1.000000,1.000000,3.429e-2,9.129e-1,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,};
// vector<float> sf_Vpt_closure_metlt80_eq1j  = {1.870e-2,2.323e-2,2.839e-2,3.512e-2,3.919e-2,4.336e-2,4.988e-2,5.235e-2,5.984e-2,6.188e-2,6.444e-2,6.762e-2,7.403e-2,6.691e-2,7.910e-2,5.227e-2,8.790e-2,8.244e-2,8.974e-2,7.632e-2,8.180e-2,7.418e-2,6.583e-2,5.747e-2,7.793e-2,1.191e-1,5.151e-2,1.088e-1,1.204e-1,1.169e-1,1.011e-1,2.671e-1,1.188e-1,1.183e-1,7.655e-3,1.000000,1.095e-1,1.035e-1,2.165e-1,8.089e-2,1.000000,1.000000,1.546e-1,6.157e-2,1.495e-2,1.000000,1.000000,8.508e-1,1.419e-1,8.510e-2,1.031e-1,1.767e-1,1.000000,2.120e-1,2.275e-1,};
vector<float> sf_Vpt_closure_metlt80_eq2j  = {1.427e-2,1.811e-2,2.256e-2,2.871e-2,3.340e-2,4.330e-2,4.169e-2,4.832e-2,4.687e-2,6.072e-2,6.064e-2,7.811e-2,6.835e-2,5.837e-2,6.131e-2,6.045e-2,7.599e-2,7.864e-2,6.813e-2,9.205e-2,5.489e-2,1.038e-1,6.175e-2,9.317e-2,6.753e-2,1.125e-1,8.432e-2,1.025e-1,1.340e-1,8.332e-2,1.026e-1,5.383e-2,1.856e-1,4.578e-2,2.297e-1,1.752e-1,3.919e-1,2.874e-1,5.642e-1,6.781e-2,3.460e-1,6.644e-2,1.000000,1.395e-1,3.397e-2,2.740e-1,1.000000,6.814e-2,2.325e+0,2.964e-1,1.000000,3.550e-1,1.000000,1.000000,1.451e-1,};
// vector<float> sf_Vpt_closure_metlt125_eq0j = {2.104e-2,2.224e-2,2.521e-2,2.529e-2,2.284e-2,2.984e-2,2.571e-2,2.693e-2,1.486e-2,1.525e-2,1.021e-2,4.843e-3,2.932e-2,1.380e-2,5.789e-2,1.000000,1.000000,1.000000,3.429e-2,3.151e-1,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,};
// vector<float> sf_Vpt_closure_metlt125_eq1j = {1.870e-2,2.325e-2,2.838e-2,3.513e-2,3.925e-2,4.320e-2,4.989e-2,5.234e-2,5.996e-2,6.145e-2,6.440e-2,6.736e-2,7.407e-2,6.755e-2,7.958e-2,5.157e-2,8.675e-2,8.188e-2,8.623e-2,7.651e-2,8.276e-2,7.446e-2,6.991e-2,5.999e-2,7.514e-2,1.172e-1,5.295e-2,1.071e-1,1.187e-1,1.100e-1,1.150e-1,2.826e-1,1.188e-1,1.312e-1,7.415e-3,1.988e-2,9.144e-2,1.035e-1,2.222e-1,8.089e-2,1.000000,1.000000,1.546e-1,4.767e-2,1.495e-2,1.000000,1.000000,8.508e-1,1.419e-1,8.510e-2,1.031e-1,1.767e-1,1.000000,2.120e-1,2.467e-1,};
vector<float> sf_Vpt_closure_metlt125_eq2j = {1.418e-2,1.809e-2,2.255e-2,2.851e-2,3.352e-2,4.293e-2,4.134e-2,4.848e-2,4.700e-2,6.119e-2,6.018e-2,7.791e-2,6.864e-2,6.012e-2,6.176e-2,5.829e-2,7.519e-2,8.036e-2,6.757e-2,8.815e-2,5.945e-2,1.008e-1,6.743e-2,9.010e-2,8.098e-2,1.072e-1,8.946e-2,1.087e-1,1.273e-1,8.221e-2,9.946e-2,6.341e-2,1.717e-1,6.662e-2,2.145e-1,1.967e-1,3.312e-1,3.066e-1,4.835e-1,6.472e-2,3.237e-1,3.344e-2,1.000000,1.395e-1,3.397e-2,2.481e-1,1.000000,6.465e-2,2.325e+0,2.964e-1,9.821e-3,2.928e-1,1.000000,1.000000,1.819e-1,};

// Barrel photon only
vector<float> sf_Vpt_data_metlt80_eq0j  = {4.128e-02,4.681e-02,5.409e-02,6.130e-02,6.892e-02,7.052e-02,6.873e-02,6.367e-02,7.059e-02,6.109e-02,7.508e-02,2.822e-02,6.439e-02,3.309e-02,4.972e-02,7.463e-03,1.146e-01,3.226e-02,6.557e-02,3.846e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,8.333e-02,1.000e+00,2.000e-01,1.000e+00,1.667e-01,1.000e+00,2.500e-01,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_data_metlt80_eq1j  = {4.353e-02,5.099e-02,6.115e-02,7.329e-02,8.099e-02,9.184e-02,9.878e-02,1.047e-01,1.102e-01,1.161e-01,1.218e-01,1.192e-01,1.268e-01,1.237e-01,1.210e-01,1.162e-01,1.186e-01,1.202e-01,1.312e-01,1.300e-01,1.313e-01,1.332e-01,1.292e-01,1.429e-01,1.443e-01,1.357e-01,1.309e-01,1.594e-01,1.371e-01,1.382e-01,1.504e-01,1.389e-01,1.720e-01,1.328e-01,1.471e-01,1.124e-01,2.289e-01,7.576e-02,2.632e-01,1.522e-01,1.707e-01,1.290e-01,3.103e-01,1.034e-01,1.579e-01,2.083e-01,2.941e-01,1.667e-01,8.333e-02,1.176e-01,1.111e-01,1.667e-01,9.091e-02,1.000e+00,1.071e-01,};
vector<float> sf_Vpt_data_metlt80_eq2j  = {3.904e-02,4.686e-02,5.762e-02,6.597e-02,7.580e-02,8.594e-02,9.239e-02,9.822e-02,1.033e-01,1.117e-01,1.141e-01,1.149e-01,1.152e-01,1.026e-01,1.174e-01,1.225e-01,1.151e-01,1.254e-01,1.148e-01,1.233e-01,9.840e-02,1.140e-01,1.435e-01,1.469e-01,1.438e-01,1.174e-01,1.132e-01,1.541e-01,1.049e-01,1.095e-01,1.188e-01,1.709e-01,1.284e-01,7.299e-02,1.739e-01,2.152e-01,1.026e-01,1.833e-01,1.379e-01,2.632e-01,1.667e-01,1.935e-01,1.795e-01,6.061e-02,4.545e-02,1.667e-01,9.091e-02,2.500e-01,6.667e-02,1.538e-01,1.250e-01,7.692e-02,2.500e-01,1.000e+00,7.692e-02,};
vector<float> sf_Vpt_data_metlt125_eq0j = {4.165e-02,4.774e-02,5.657e-02,6.673e-02,7.924e-02,8.854e-02,9.450e-02,9.588e-02,1.094e-01,8.473e-02,1.084e-01,4.575e-02,6.230e-02,4.000e-02,4.695e-02,1.961e-02,1.048e-01,2.985e-02,6.452e-02,5.882e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,7.692e-02,1.000e+00,2.000e-01,1.000e+00,1.429e-01,1.000e+00,2.500e-01,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_data_metlt125_eq1j = {4.372e-02,5.131e-02,6.158e-02,7.379e-02,8.170e-02,9.288e-02,1.001e-01,1.059e-01,1.118e-01,1.174e-01,1.234e-01,1.208e-01,1.286e-01,1.248e-01,1.225e-01,1.172e-01,1.180e-01,1.200e-01,1.313e-01,1.317e-01,1.309e-01,1.344e-01,1.282e-01,1.413e-01,1.419e-01,1.365e-01,1.270e-01,1.569e-01,1.405e-01,1.413e-01,1.496e-01,1.357e-01,1.779e-01,1.308e-01,1.538e-01,1.183e-01,2.184e-01,7.246e-02,2.542e-01,1.400e-01,1.667e-01,1.290e-01,2.903e-01,9.375e-02,1.538e-01,1.786e-01,2.941e-01,1.667e-01,7.692e-02,1.111e-01,1.111e-01,1.667e-01,8.333e-02,1.000e+00,9.677e-02,};
vector<float> sf_Vpt_data_metlt125_eq2j = {3.948e-02,4.735e-02,5.831e-02,6.674e-02,7.670e-02,8.704e-02,9.302e-02,9.921e-02,1.047e-01,1.131e-01,1.152e-01,1.161e-01,1.159e-01,1.036e-01,1.187e-01,1.218e-01,1.164e-01,1.252e-01,1.156e-01,1.253e-01,9.829e-02,1.195e-01,1.459e-01,1.503e-01,1.474e-01,1.164e-01,1.149e-01,1.529e-01,1.029e-01,1.043e-01,1.232e-01,1.646e-01,1.290e-01,8.511e-02,1.771e-01,2.000e-01,1.000e-01,1.719e-01,1.613e-01,2.439e-01,1.515e-01,1.875e-01,1.750e-01,5.714e-02,4.545e-02,1.600e-01,9.091e-02,2.500e-01,5.556e-02,1.538e-01,1.250e-01,7.692e-02,2.222e-01,1.000e+00,8.696e-02,};

vector<float> sf_Vpt_data18_metlt80_eq0j  = {2.541e-02,3.134e-02,3.931e-02,4.774e-02,5.603e-02,7.384e-02,9.374e-02,9.963e-02,1.039e-01,1.227e-01,1.649e-01,1.345e-01,1.639e-01,2.548e-01,1.833e-01,2.225e-01,1.443e-01,1.818e-01,3.704e-02,1.728e-01,2.857e-01,6.667e-01,2.222e-01,7.143e-02,1.000e+00,1.000e+00,2.015e-01,1.000e+00,1.000e+00,1.000e+00,5.000e-01,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_data18_metlt80_eq1j  = {2.800e-02,3.397e-02,4.473e-02,5.255e-02,6.325e-02,7.187e-02,7.894e-02,8.346e-02,8.994e-02,9.345e-02,9.988e-02,1.015e-01,1.045e-01,1.106e-01,1.085e-01,1.143e-01,1.146e-01,1.113e-01,1.098e-01,1.102e-01,1.054e-01,1.086e-01,1.080e-01,1.183e-01,9.637e-02,1.116e-01,1.179e-01,1.071e-01,9.960e-02,8.355e-02,1.088e-01,1.020e-01,9.379e-02,1.072e-01,1.117e-01,1.347e-01,7.526e-02,9.154e-02,7.467e-02,8.942e-02,1.616e-01,1.159e-01,1.396e-01,1.218e-01,7.254e-02,9.388e-02,1.021e-01,1.821e-01,5.000e-02,5.266e-02,7.899e-02,2.941e-02,1.000e+00,8.012e-02,6.821e-02,};
vector<float> sf_Vpt_data18_metlt80_eq2j  = {2.240e-02,2.926e-02,4.006e-02,4.996e-02,5.530e-02,6.645e-02,7.234e-02,7.935e-02,8.284e-02,8.530e-02,8.850e-02,9.459e-02,9.980e-02,1.032e-01,1.059e-01,1.067e-01,1.074e-01,1.099e-01,1.121e-01,1.078e-01,1.108e-01,1.123e-01,1.054e-01,9.713e-02,9.650e-02,1.045e-01,1.071e-01,1.066e-01,8.841e-02,1.202e-01,8.582e-02,1.128e-01,9.814e-02,1.120e-01,8.865e-02,1.470e-01,7.813e-02,1.269e-01,7.638e-02,7.629e-02,1.364e-01,1.319e-01,3.263e-02,1.168e-01,7.147e-02,5.975e-02,1.224e-01,8.333e-02,1.465e-01,2.705e-02,3.572e-02,7.706e-02,5.884e-02,1.000e+00,7.810e-02,};
vector<float> sf_Vpt_data18_metlt125_eq0j = {2.554e-02,3.162e-02,3.994e-02,4.912e-02,5.885e-02,8.112e-02,1.033e-01,1.032e-01,1.125e-01,1.470e-01,1.591e-01,1.453e-01,1.841e-01,2.577e-01,2.024e-01,2.224e-01,1.849e-01,1.824e-01,3.451e-02,1.616e-01,2.667e-01,4.007e-01,2.727e-01,5.884e-02,1.000e+00,1.000e+00,1.677e-01,1.000e+00,1.000e+00,1.429e-01,5.000e-01,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_data18_metlt125_eq1j = {2.792e-02,3.399e-02,4.475e-02,5.262e-02,6.336e-02,7.226e-02,7.953e-02,8.385e-02,9.066e-02,9.358e-02,1.004e-01,1.019e-01,1.055e-01,1.112e-01,1.088e-01,1.167e-01,1.156e-01,1.131e-01,1.099e-01,1.105e-01,1.050e-01,1.078e-01,1.064e-01,1.153e-01,9.592e-02,1.096e-01,1.169e-01,1.031e-01,9.821e-02,8.849e-02,1.081e-01,1.096e-01,8.852e-02,1.038e-01,1.060e-01,1.342e-01,7.129e-02,9.205e-02,7.340e-02,8.327e-02,1.356e-01,1.155e-01,1.325e-01,1.327e-01,9.878e-02,9.112e-02,1.322e-01,1.721e-01,4.450e-02,4.654e-02,6.533e-02,2.634e-02,1.000e+00,7.152e-02,6.701e-02,};
vector<float> sf_Vpt_data18_metlt125_eq2j = {2.244e-02,2.935e-02,3.990e-02,5.007e-02,5.538e-02,6.669e-02,7.227e-02,8.012e-02,8.284e-02,8.566e-02,8.905e-02,9.554e-02,1.005e-01,1.021e-01,1.074e-01,1.066e-01,1.079e-01,1.108e-01,1.104e-01,1.063e-01,1.100e-01,1.092e-01,1.062e-01,9.576e-02,9.317e-02,1.076e-01,1.056e-01,1.156e-01,8.795e-02,1.189e-01,8.574e-02,1.152e-01,1.008e-01,1.017e-01,9.387e-02,1.372e-01,7.604e-02,1.280e-01,7.652e-02,7.758e-02,1.202e-01,1.315e-01,3.926e-02,1.130e-01,6.790e-02,5.268e-02,1.134e-01,6.978e-02,1.525e-01,5.017e-02,6.256e-02,6.267e-02,5.563e-02,1.000e+00,7.445e-02,};

// // metcrtd
// vector<float> sf_Vpt_closure18_metlt80_eq0j  = {3.633e-02,3.952e-02,4.439e-02,5.253e-02,7.362e-02,7.161e-02,1.004e-01,1.149e-01,1.892e-01,7.824e-02,5.059e-01,1.123e-01,2.717e-01,1.028e-01,5.384e-01,3.772e-01,1.000e+00,1.219e-01,1.000e+00,7.363e-02,1.000e+00,2.516e-01,1.000e+00,1.000e+00,5.829e-01,1.000e+00,5.320e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
// vector<float> sf_Vpt_closure18_metlt80_eq1j  = {3.344e-02,4.145e-02,5.051e-02,5.941e-02,7.260e-02,8.247e-02,9.044e-02,9.990e-02,1.036e-01,1.054e-01,1.094e-01,1.186e-01,1.181e-01,1.281e-01,1.532e-01,1.312e-01,1.568e-01,1.252e-01,1.372e-01,1.528e-01,1.427e-01,1.459e-01,1.541e-01,1.537e-01,1.303e-01,1.133e-01,1.146e-01,1.494e-01,2.592e-01,1.832e-01,2.817e-01,1.176e-01,1.481e-01,1.146e-01,1.127e-01,1.222e-01,4.444e-01,2.891e-01,2.899e-01,4.902e-01,1.000e+00,4.413e-01,5.042e-01,9.217e-02,1.199e-01,1.000e+00,2.980e-01,2.889e-02,1.000e+00,1.000e+00,2.081e-02,5.848e-01,4.143e-01,1.000e+00,1.096e-01,};
// vector<float> sf_Vpt_closure18_metlt80_eq2j  = {2.520e-02,3.189e-02,4.381e-02,5.233e-02,6.261e-02,7.426e-02,8.472e-02,9.643e-02,1.001e-01,1.126e-01,9.472e-02,9.990e-02,1.338e-01,1.370e-01,1.356e-01,1.423e-01,1.677e-01,1.667e-01,1.373e-01,1.380e-01,1.395e-01,1.331e-01,1.228e-01,1.550e-01,1.778e-01,1.838e-01,1.446e-01,1.552e-01,2.141e-01,8.831e-02,1.397e-01,1.400e-01,1.371e-01,1.461e-01,2.280e-01,7.264e-02,5.425e-03,1.312e-01,1.448e-01,8.218e-03,7.245e-03,1.000e+00,5.571e-01,3.318e-01,2.677e-01,6.973e-02,4.084e-02,1.796e-01,5.819e-01,2.573e-02,1.099e-01,3.373e-01,1.000e+00,3.921e-02,2.110e-01,};
// vector<float> sf_Vpt_closure18_metlt125_eq0j = {3.629e-02,3.951e-02,4.439e-02,5.237e-02,7.397e-02,7.584e-02,1.081e-01,1.146e-01,1.767e-01,9.280e-02,4.895e-01,1.294e-01,3.296e-01,1.028e-01,5.384e-01,3.772e-01,1.000e+00,1.810e-01,1.000e+00,7.363e-02,1.000e+00,2.516e-01,1.000e+00,1.000e+00,5.829e-01,1.000e+00,5.320e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
// vector<float> sf_Vpt_closure18_metlt125_eq1j = {3.342e-02,4.148e-02,5.057e-02,5.951e-02,7.265e-02,8.294e-02,9.024e-02,1.000e-01,1.035e-01,1.053e-01,1.108e-01,1.185e-01,1.186e-01,1.286e-01,1.547e-01,1.330e-01,1.560e-01,1.257e-01,1.342e-01,1.569e-01,1.359e-01,1.469e-01,1.536e-01,1.632e-01,1.305e-01,1.157e-01,9.671e-02,1.500e-01,2.592e-01,1.770e-01,2.757e-01,1.109e-01,1.360e-01,1.244e-01,1.267e-01,1.036e-01,4.579e-01,2.915e-01,2.899e-01,4.902e-01,1.000e+00,4.896e-01,4.643e-01,8.065e-02,1.136e-01,1.000e+00,2.980e-01,2.826e-02,1.000e+00,1.000e+00,1.992e-02,3.881e-01,4.143e-01,1.000e+00,1.012e-01,};
// vector<float> sf_Vpt_closure18_metlt125_eq2j = {2.545e-02,3.192e-02,4.364e-02,5.236e-02,6.250e-02,7.469e-02,8.509e-02,9.708e-02,9.952e-02,1.129e-01,9.499e-02,9.918e-02,1.317e-01,1.375e-01,1.329e-01,1.420e-01,1.685e-01,1.667e-01,1.443e-01,1.380e-01,1.321e-01,1.341e-01,1.251e-01,1.480e-01,1.758e-01,1.820e-01,1.503e-01,1.405e-01,2.053e-01,8.749e-02,1.358e-01,1.352e-01,1.411e-01,1.549e-01,3.372e-01,4.389e-02,8.782e-02,1.174e-01,1.547e-01,2.629e-02,1.000e+00,1.000e+00,5.122e-01,3.189e-01,2.108e-01,6.618e-02,1.000e+00,6.692e-02,5.772e-01,2.573e-02,1.058e-01,5.321e-01,1.000e+00,3.921e-02,1.925e-01,};

// metTTT
vector<float> sf_Vpt_closure18_metlt80_eq0j  = {3.633e-02,3.944e-02,4.415e-02,5.282e-02,7.359e-02,7.139e-02,1.024e-01,1.141e-01,1.892e-01,8.326e-02,5.059e-01,1.123e-01,2.603e-01,1.028e-01,5.384e-01,3.772e-01,1.000e+00,1.794e-01,1.000e+00,7.363e-02,1.000e+00,2.516e-01,1.000e+00,1.000e+00,5.829e-01,1.000e+00,5.320e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_closure18_metlt80_eq1j  = {3.344e-02,4.144e-02,5.047e-02,5.932e-02,7.251e-02,8.258e-02,9.051e-02,1.002e-01,1.027e-01,1.059e-01,1.098e-01,1.187e-01,1.173e-01,1.283e-01,1.535e-01,1.317e-01,1.575e-01,1.254e-01,1.377e-01,1.540e-01,1.436e-01,1.462e-01,1.560e-01,1.537e-01,1.303e-01,1.142e-01,1.119e-01,1.477e-01,2.577e-01,1.751e-01,2.845e-01,1.176e-01,1.545e-01,1.146e-01,1.043e-01,1.203e-01,4.664e-01,2.891e-01,2.899e-01,4.902e-01,1.000e+00,4.413e-01,5.042e-01,9.217e-02,1.199e-01,1.000e+00,2.980e-01,2.889e-02,1.000e+00,1.000e+00,2.081e-02,3.935e-01,4.143e-01,1.000e+00,1.096e-01,};
vector<float> sf_Vpt_closure18_metlt80_eq2j  = {2.524e-02,3.184e-02,4.381e-02,5.223e-02,6.248e-02,7.424e-02,8.495e-02,9.648e-02,1.006e-01,1.126e-01,9.503e-02,1.002e-01,1.330e-01,1.366e-01,1.354e-01,1.429e-01,1.698e-01,1.677e-01,1.407e-01,1.416e-01,1.389e-01,1.327e-01,1.205e-01,1.550e-01,1.785e-01,1.844e-01,1.372e-01,1.604e-01,2.085e-01,8.295e-02,1.458e-01,1.482e-01,1.348e-01,1.497e-01,2.233e-01,7.264e-02,5.425e-03,1.261e-01,1.448e-01,8.218e-03,7.245e-03,1.000e+00,5.660e-01,3.318e-01,2.677e-01,6.973e-02,4.021e-02,1.242e-01,5.819e-01,2.573e-02,1.099e-01,3.373e-01,1.000e+00,3.921e-02,2.110e-01,};
vector<float> sf_Vpt_closure18_metlt125_eq0j = {3.631e-02,3.945e-02,4.437e-02,5.238e-02,7.398e-02,7.605e-02,1.092e-01,1.146e-01,1.767e-01,9.280e-02,4.895e-01,1.294e-01,3.914e-01,1.028e-01,5.384e-01,3.772e-01,1.000e+00,1.810e-01,1.000e+00,7.363e-02,1.000e+00,2.516e-01,1.000e+00,1.000e+00,5.829e-01,1.000e+00,5.320e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_closure18_metlt125_eq1j = {3.342e-02,4.147e-02,5.057e-02,5.945e-02,7.259e-02,8.287e-02,9.034e-02,1.000e-01,1.031e-01,1.053e-01,1.108e-01,1.185e-01,1.186e-01,1.288e-01,1.547e-01,1.324e-01,1.560e-01,1.257e-01,1.342e-01,1.569e-01,1.372e-01,1.469e-01,1.530e-01,1.613e-01,1.276e-01,1.184e-01,9.671e-02,1.500e-01,2.592e-01,1.770e-01,2.757e-01,1.109e-01,1.431e-01,1.244e-01,1.473e-01,1.036e-01,4.579e-01,2.915e-01,2.899e-01,4.902e-01,1.000e+00,4.896e-01,4.643e-01,8.065e-02,1.136e-01,1.000e+00,2.980e-01,2.826e-02,1.000e+00,1.000e+00,1.992e-02,3.881e-01,4.143e-01,1.000e+00,1.012e-01,};
vector<float> sf_Vpt_closure18_metlt125_eq2j = {2.543e-02,3.190e-02,4.363e-02,5.225e-02,6.250e-02,7.476e-02,8.535e-02,9.695e-02,9.977e-02,1.127e-01,9.496e-02,9.924e-02,1.318e-01,1.375e-01,1.327e-01,1.423e-01,1.685e-01,1.667e-01,1.443e-01,1.376e-01,1.321e-01,1.341e-01,1.251e-01,1.480e-01,1.761e-01,1.820e-01,1.503e-01,1.395e-01,2.053e-01,9.272e-02,1.409e-01,1.352e-01,1.411e-01,1.549e-01,3.372e-01,4.389e-02,8.782e-02,1.174e-01,1.547e-01,2.629e-02,1.000e+00,1.000e+00,5.122e-01,3.189e-01,2.108e-01,6.618e-02,1.000e+00,6.692e-02,5.772e-01,2.573e-02,1.058e-01,5.321e-01,1.000e+00,3.921e-02,1.925e-01,};


vector<float> sf_Vpt_closure_metlt80_eq0j  = {3.856e-02,4.281e-02,4.996e-02,5.102e-02,4.765e-02,6.589e-02,6.656e-02,5.675e-02,2.929e-02,2.252e-02,2.017e-02,1.064e-02,6.561e-02,2.283e-02,9.441e-02,1.000e+00,1.000e+00,1.000e+00,4.674e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_closure_metlt80_eq1j  = {3.339e-02,4.105e-02,5.076e-02,6.402e-02,7.147e-02,7.837e-02,9.065e-02,9.740e-02,1.030e-01,1.123e-01,1.123e-01,1.137e-01,1.222e-01,1.012e-01,1.276e-01,8.859e-02,1.357e-01,1.265e-01,1.475e-01,1.144e-01,1.246e-01,1.171e-01,1.002e-01,9.039e-02,1.175e-01,1.936e-01,8.454e-02,1.650e-01,2.109e-01,1.752e-01,1.703e-01,3.628e-01,1.456e-01,1.903e-01,9.324e-03,1.000e+00,1.942e-01,1.461e-01,2.771e-01,1.255e-01,1.000e+00,1.000e+00,1.974e-01,6.157e-02,1.820e-02,1.000e+00,1.000e+00,1.217e+00,2.330e-01,1.244e-01,1.031e-01,2.483e-01,1.000e+00,2.257e-01,3.210e-01,};
// vector<float> sf_Vpt_closure_metlt80_eq2j  = {2.681e-02,3.470e-02,4.493e-02,5.341e-02,6.223e-02,8.507e-02,8.152e-02,8.464e-02,8.639e-02,1.227e-01,1.112e-01,1.357e-01,1.371e-01,1.161e-01,1.096e-01,1.074e-01,1.313e-01,1.464e-01,1.204e-01,1.615e-01,9.180e-02,1.833e-01,1.098e-01,1.445e-01,1.163e-01,2.009e-01,1.308e-01,1.595e-01,2.167e-01,1.406e-01,1.350e-01,8.033e-02,2.768e-01,7.499e-02,3.221e-01,2.682e-01,6.538e-01,3.324e-01,8.148e-01,9.420e-02,4.691e-01,1.814e-01,1.000e+00,2.083e-01,6.885e-02,3.747e-01,1.000e+00,7.764e-02,6.592e+00,3.512e-01,1.000e+00,5.013e-01,1.000e+00,1.000e+00,1.887e-01,};
vector<float> sf_Vpt_closure_metlt125_eq0j = {3.865e-02,4.290e-02,4.991e-02,5.149e-02,4.787e-02,6.547e-02,6.350e-02,5.359e-02,3.433e-02,2.438e-02,1.948e-02,1.030e-02,6.561e-02,2.283e-02,9.441e-02,1.000e+00,1.000e+00,1.000e+00,4.674e-02,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,1.000e+00,};
vector<float> sf_Vpt_closure_metlt125_eq1j = {3.340e-02,4.110e-02,5.077e-02,6.405e-02,7.149e-02,7.835e-02,9.090e-02,9.744e-02,1.034e-01,1.109e-01,1.124e-01,1.129e-01,1.222e-01,1.033e-01,1.281e-01,8.725e-02,1.348e-01,1.266e-01,1.418e-01,1.141e-01,1.266e-01,1.161e-01,1.068e-01,9.435e-02,1.152e-01,1.936e-01,8.476e-02,1.620e-01,2.100e-01,1.681e-01,1.865e-01,3.839e-01,1.456e-01,2.054e-01,9.324e-03,2.837e-02,1.625e-01,1.461e-01,2.844e-01,1.255e-01,1.000e+00,1.000e+00,1.974e-01,4.767e-02,1.820e-02,1.000e+00,1.000e+00,1.217e+00,2.330e-01,1.244e-01,1.031e-01,2.483e-01,1.000e+00,2.257e-01,3.421e-01,};
// vector<float> sf_Vpt_closure_metlt125_eq2j = {2.662e-02,3.465e-02,4.495e-02,5.293e-02,6.247e-02,8.409e-02,8.122e-02,8.506e-02,8.673e-02,1.234e-01,1.103e-01,1.355e-01,1.387e-01,1.197e-01,1.110e-01,1.032e-01,1.293e-01,1.503e-01,1.200e-01,1.578e-01,1.002e-01,1.792e-01,1.194e-01,1.385e-01,1.405e-01,1.939e-01,1.400e-01,1.688e-01,2.014e-01,1.378e-01,1.343e-01,9.451e-02,2.768e-01,1.068e-01,2.931e-01,3.189e-01,6.130e-01,3.521e-01,8.853e-01,8.833e-02,4.691e-01,9.131e-02,1.000e+00,2.083e-01,6.885e-02,3.465e-01,1.000e+00,7.315e-02,6.592e+00,3.512e-01,2.485e-02,3.857e-01,1.000e+00,1.000e+00,2.423e-01,};


// Extended photon eta at 2j
vector<float> sf_Vpt_closure16_metlt125_ee2j = {1.066e-02,1.412e-02,1.842e-02,2.435e-02,2.910e-02,3.755e-02,3.712e-02,4.351e-02,4.126e-02,5.259e-02,5.128e-02,6.832e-02,5.988e-02,5.568e-02,6.330e-02,5.212e-02,7.501e-02,6.832e-02,5.499e-02,6.995e-02,5.359e-02,8.321e-02,5.665e-02,8.114e-02,7.398e-02,9.243e-02,7.856e-02,8.470e-02,1.069e-01,8.410e-02,8.371e-02,7.157e-02,1.689e-01,4.014e-02,1.934e-01,1.924e-01,2.456e-01,1.982e-01,5.248e-01,6.587e-02,2.114e-01,4.370e-02,1.000e+00,1.091e-01,4.743e-02,2.845e-01,1.000e+00,6.882e-02,9.676e-01,2.526e-01,1.205e-02,1.147e-01,1.000e+00,1.000e+00,1.266e-01,};

vector<float> sf_Veta_data16_metlt80_ee2j = {5.267e-03,7.880e-03,8.682e-03,8.716e-03,1.179e-02,9.973e-03,1.170e-02,1.197e-02,1.453e-02,2.302e-02,4.678e-02,3.925e-02,3.778e-02,3.663e-02,3.146e-02,2.620e-02,2.778e-02,2.556e-02,2.424e-02,2.415e-02,2.498e-02,2.209e-02,2.090e-02,2.204e-02,2.089e-02,2.145e-02,2.257e-02,2.237e-02,2.124e-02,2.437e-02,2.474e-02,2.378e-02,2.493e-02,2.767e-02,2.670e-02,2.871e-02,3.785e-02,3.809e-02,4.122e-02,4.560e-02,2.054e-02,1.432e-02,1.254e-02,1.097e-02,1.010e-02,9.931e-03,9.272e-03,9.774e-03,8.030e-03,5.091e-03,};
vector<float> sf_Veta_data16_metlt125_ee2j = {5.242e-03,7.867e-03,8.671e-03,8.688e-03,1.171e-02,9.974e-03,1.166e-02,1.194e-02,1.441e-02,2.282e-02,4.710e-02,3.966e-02,3.827e-02,3.681e-02,3.177e-02,2.629e-02,2.791e-02,2.571e-02,2.430e-02,2.426e-02,2.507e-02,2.229e-02,2.104e-02,2.204e-02,2.112e-02,2.149e-02,2.268e-02,2.249e-02,2.120e-02,2.450e-02,2.477e-02,2.405e-02,2.496e-02,2.766e-02,2.686e-02,2.882e-02,3.838e-02,3.817e-02,4.109e-02,4.540e-02,2.023e-02,1.439e-02,1.245e-02,1.092e-02,1.001e-02,9.880e-03,9.235e-03,9.801e-03,7.977e-03,5.064e-03,};

vector<float> sf_Vpt_flateta_data16_metlt80_ee2j = {5.099e-01,6.867e-01,9.581e-01,1.205e+00,1.421e+00,1.648e+00,1.799e+00,2.007e+00,2.170e+00,2.327e+00,2.425e+00,2.517e+00,2.480e+00,2.567e+00,2.742e+00,2.984e+00,2.646e+00,2.731e+00,2.608e+00,2.770e+00,2.272e+00,2.548e+00,3.079e+00,3.082e+00,3.471e+00,2.773e+00,2.646e+00,3.045e+00,2.288e+00,2.230e+00,2.355e+00,3.300e+00,2.978e+00,1.832e+00,3.796e+00,4.943e+00,2.504e+00,1.209e+00,2.747e+00,4.875e+00,3.708e+00,3.233e+00,3.584e+00,1.864e+00,1.168e+00,4.849e+00,2.980e+00,5.705e+00,1.000e+00,2.529e+00,4.202e+00,2.507e+00,7.759e+00,1.000e+00,1.753e+00,};
vector<float> sf_Vpt_flateta_data16_metlt125_ee2j = {5.139e-01,6.927e-01,9.671e-01,1.221e+00,1.444e+00,1.657e+00,1.805e+00,2.027e+00,2.188e+00,2.355e+00,2.500e+00,2.542e+00,2.491e+00,2.661e+00,2.800e+00,3.099e+00,2.815e+00,2.538e+00,2.607e+00,2.828e+00,2.251e+00,3.084e+00,3.160e+00,3.174e+00,3.471e+00,2.743e+00,2.705e+00,3.182e+00,2.245e+00,2.187e+00,2.421e+00,3.213e+00,3.050e+00,1.820e+00,4.040e+00,4.816e+00,2.433e+00,1.188e+00,3.634e+00,4.860e+00,3.485e+00,3.118e+00,3.511e+00,1.795e+00,1.163e+00,4.713e+00,2.918e+00,5.747e+00,1.000e+00,2.265e+00,4.523e+00,2.330e+00,6.380e+00,1.000e+00,2.004e+00,};

// With conversion veto, barrel only
vector<float> sf_Vpt_v0_data16_metlt80_eq0j  = {2.493e-02,2.846e-02,3.157e-02,3.216e-02,3.010e-02,2.516e-02,2.037e-02,1.483e-02,1.547e-02,1.185e-02,1.131e-02,4.923e-03,9.235e-03,6.851e-03,8.216e-03,6.216e-03,3.782e-03,2.288e-03,2.809e-03,3.922e-03,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,3.006e-02,0.000e+00,3.448e-02,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.429e-00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,};
vector<float> sf_Vpt_v0_data16_metlt80_eq1j  = {3.052e-02,3.824e-02,4.909e-02,6.054e-02,6.882e-02,7.855e-02,8.582e-02,9.047e-02,9.460e-02,1.021e-01,1.048e-01,1.033e-01,1.091e-01,1.204e-01,1.165e-01,1.121e-01,1.110e-01,1.062e-01,1.158e-01,1.101e-01,1.112e-01,1.117e-01,1.163e-01,1.316e-01,1.281e-01,1.203e-01,1.211e-01,1.411e-01,1.116e-01,1.029e-01,1.185e-01,1.365e-01,1.322e-01,1.261e-01,7.212e-02,8.509e-02,1.906e-01,6.258e-02,2.144e-01,1.042e-01,1.555e-01,1.001e-01,3.108e-01,9.386e-02,1.667e-01,1.251e-01,2.941e-01,1.500e-01,9.091e-02,1.113e-01,1.000e+00,2.000e-01,8.333e-02,1.000e+00,1.134e-01,};
vector<float> sf_Vpt_v0_data16_metlt80_eq2j  = {2.836e-02,3.613e-02,4.722e-02,5.822e-02,6.798e-02,7.803e-02,8.576e-02,9.444e-02,9.864e-02,1.048e-01,1.078e-01,1.116e-01,1.133e-01,1.099e-01,1.284e-01,1.335e-01,1.225e-01,1.175e-01,1.118e-01,1.245e-01,9.064e-02,1.124e-01,1.340e-01,1.353e-01,1.527e-01,1.186e-01,1.165e-01,1.347e-01,1.042e-01,9.580e-02,1.012e-01,1.458e-01,1.114e-01,7.567e-02,1.648e-01,2.112e-01,1.001e-01,1.368e-01,1.001e-01,2.222e-01,1.516e-01,1.483e-01,1.350e-01,7.703e-02,5.259e-02,1.744e-01,1.055e-01,2.003e-01,1.000e+00,1.004e-01,1.442e-01,7.176e-02,2.500e-01,1.000e+00,7.271e-02,};
vector<float> sf_Vpt_v0_data16_metlt125_eq0j = {2.499e-02,2.872e-02,3.234e-02,3.384e-02,3.264e-02,2.968e-02,2.603e-02,1.952e-02,2.170e-02,1.524e-02,1.358e-02,6.620e-03,9.483e-03,6.423e-03,8.856e-03,1.537e-03,1.643e-02,2.092e-03,2.532e-03,6.735e-03,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,2.758e-02,0.000e+00,2.857e-02,0.000e+00,0.000e+00,0.000e+00,0.000e+00,8.333e-02,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,0.000e+00,};
vector<float> sf_Vpt_v0_data16_metlt125_eq1j = {3.056e-02,3.831e-02,4.926e-02,6.067e-02,6.901e-02,7.895e-02,8.648e-02,9.090e-02,9.505e-02,1.029e-01,1.059e-01,1.039e-01,1.105e-01,1.206e-01,1.179e-01,1.129e-01,1.100e-01,1.049e-01,1.163e-01,1.109e-01,1.117e-01,1.117e-01,1.144e-01,1.311e-01,1.268e-01,1.200e-01,1.181e-01,1.412e-01,1.158e-01,1.042e-01,1.193e-01,1.339e-01,1.282e-01,1.214e-01,8.046e-02,9.000e-02,1.820e-01,5.981e-02,2.071e-01,9.620e-02,1.523e-01,9.681e-02,3.005e-01,8.828e-02,1.622e-01,1.073e-01,2.946e-01,1.500e-01,8.348e-02,1.001e-01,1.000e+00,2.000e-01,7.718e-02,1.000e+00,1.003e-01,};
vector<float> sf_Vpt_v0_data16_metlt125_eq2j = {2.844e-02,3.628e-02,4.745e-02,5.849e-02,6.834e-02,7.835e-02,8.606e-02,9.468e-02,9.968e-02,1.054e-01,1.089e-01,1.116e-01,1.131e-01,1.104e-01,1.301e-01,1.329e-01,1.241e-01,1.165e-01,1.113e-01,1.262e-01,8.975e-02,1.183e-01,1.355e-01,1.387e-01,1.544e-01,1.154e-01,1.181e-01,1.347e-01,1.015e-01,9.104e-02,1.017e-01,1.403e-01,1.121e-01,7.327e-02,1.709e-01,1.976e-01,9.738e-02,1.328e-01,1.275e-01,2.112e-01,1.431e-01,1.431e-01,1.317e-01,7.172e-02,5.264e-02,1.543e-01,1.055e-01,2.003e-01,1.000e+00,1.004e-01,1.446e-01,6.695e-02,2.222e-01,1.000e+00,8.771e-02,};

vector<float> sf_Vpt_v1_data16_metlt125_eq0j = {2.580e-02,3.082e-02,3.382e-02,3.346e-02,3.117e-02,2.759e-02,2.216e-02,2.065e-02,1.697e-02,1.569e-02,7.314e-03,8.030e-03,5.323e-03,};
vector<float> sf_Vpt_v1_data16_metlt125_eq1j = {3.302e-02,4.339e-02,5.473e-02,6.488e-02,7.416e-02,8.262e-02,8.959e-02,9.296e-02,9.858e-02,1.025e-01,1.051e-01,1.146e-01,1.144e-01,};
vector<float> sf_Vpt_v1_data16_metlt125_eq2j = {3.134e-02,4.069e-02,5.259e-02,6.477e-02,7.251e-02,8.110e-02,9.195e-02,9.669e-02,1.018e-01,1.076e-01,1.113e-01,1.117e-01,1.235e-01,};

vector<float> sf_Vpt_data16_metlt125_eq0j = {2.580e-02,3.082e-02,3.382e-02,3.346e-02,3.117e-02,2.759e-02,2.216e-02,2.065e-02,1.697e-02,1.569e-02,7.314e-03,8.030e-03,5.323e-03,};
vector<float> sf_Vpt_data16_metlt125_eq1j = {3.302e-02,4.339e-02,5.473e-02,6.488e-02,7.416e-02,8.262e-02,8.959e-02,9.296e-02,9.858e-02,1.025e-01,1.051e-01,1.146e-01,1.144e-01,};
vector<float> sf_Vpt_data16_metlt125_eq2j = {3.134e-02,4.069e-02,5.259e-02,6.477e-02,7.251e-02,8.110e-02,9.195e-02,9.669e-02,1.018e-01,1.076e-01,1.113e-01,1.117e-01,1.235e-01,};

// const vector<float> ZptScales_metlt125_eq0j = {
//   0.303,0.711,2.370,6.244,15.782,32.676,52.824,69.472,321.420,216.019,2456.583,511.858,1215.240,1.000,2277.293,995.006,2054.229,1.000,
//   1460.955,1.000,1.000,1.000,650.888,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,
// };
// const vector<float> ZptScales_metlt125_geq1j = {
//   0.318,0.504,1.026,1.560,2.079,2.574,2.907,3.396,3.835,4.063,4.533,5.093,5.450,5.874,5.915,6.391,6.402,7.112,7.361,7.781,8.520,8.946,
//   8.470,9.700,9.463,10.408,11.027,12.357,13.415,11.981,11.824,12.100,13.823,15.594,11.959,12.248,14.183,14.637,14.830,19.800,
// };
// const vector<float> ZptScales_metlt125_vbf = {
//   0.257,0.426,1.055,1.697,2.378,2.992,3.869,5.294,4.734,5.063,5.471,7.652,5.668,9.924,13.728,12.142,9.233,9.569,9.737,14.474,17.528,
//   11.259,21.261,19.767,12.918,13.140,34.143,27.674,18.033,16.624,77.219,63.308,36.678,31.504,22.478,8.929,29.569,43.050,6.380,27.167,
// };

/// skimsamp scales
// const vector<float> ZptScales_metlt125_eq0j = {
//   0.240,0.605,1.935,6.026,19.342,16.151,39.965,112.539,129.201,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,
// };
const vector<float> ZptScales_metlt125_geq1j = {
  0.182,0.358,1.033,1.834,2.700,3.877,4.914,5.907,7.181,7.338,9.153,10.203,11.964,13.281,13.917,15.404,17.929,17.710,18.524,17.713,20.240,22.879,21.061,24.833,24.868,37.319,36.675,38.879,33.582,31.623,46.451,33.645,38.222,47.081,53.334,63.255,55.250,37.297,78.996,86.991,
};
const vector<float> ZptScales_metlt125_vbf = {
  0.126,0.320,1.034,2.070,2.536,4.489,6.494,9.851,19.694,7.757,14.279,9.704,43.227,36.540,51.145,224.283,25.663,15.819,32.099,38.174,39.869,19.558,12.735,33.645,1.000,17.165,60.173,293.238,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,251.445,1.000,
};



const vector<float> ZptScales_ge1j = {  // fullMET scales
  0.2479, 0.4396, 1.0611, 1.7171, 2.2895, 2.8840, 3.4497, 4.0145, 4.6117, 5.0669, 5.5740, 6.2028, 6.8047, 7.2358, 7.4380, 8.1463, 8.2290, 8.8619, 9.4767,
  9.7790, 10.871, 11.240, 11.033, 12.498, 11.880, 12.928, 14.301, 14.254, 13.718, 14.464, 14.106, 14.605, 15.548, 16.674, 13.901, 14.642, 15.766, 17.703, 16.980, 19.460
};

// const vector<float> ZptScales_metlt125_geq1j = {  // metlt125 scales, after nvtx reweighting
//   0.175, 0.363, 1.115, 2.087, 3.015, 4.464, 5.777, 7.042, 8.598, 10.254, 11.583, 12.635, 15.375, 17.863, 18.317, 23.622, 22.272, 27.349, 32.082, 31.239, 34.215,
//   38.672, 34.973, 44.256, 35.599, 43.363, 63.229, 70.996, 52.576, 94.293, 52.712, 67.331, 89.351, 76.671, 91.038, 101.63, 124.63, 83.547, 109.45, 116.65
// };

const vector<float> nvtxScales_geq1j = {
  1.0,0.4220,0.9470,0.8765,0.9212,0.8663,0.9956,0.9998,1.0256,1.0485,1.0751,1.1243,1.1327,1.1130,1.1054,1.1134,1.1450,1.1251,1.1030,1.1148,1.0978,1.0895,1.0856,1.0617,
  1.0456,1.0315,1.0315,1.0130,1.0000,0.9844,0.9878,0.9541,0.9292,0.9208,0.9131,0.9201,0.8841,0.8773,0.8570,0.8318,0.8476,0.8178,0.8149,0.8081,0.7753,0.7842,0.7684,
  0.7497,0.7061,0.7086,0.6883,0.6896,0.6986,0.6432,0.7483,0.6626,0.7026,0.7309,0.6057,0.5898,0.7814,0.5291,0.5032,0.6520,0.7479,0.4508,0.6558,0.6411,0.3271,0.8142,
  0.5261,1.0970,0.5000,0.7565,0.4186,0.4921,0.6415,0.1793,2.7859,0.5545};

// const vector<float> nvtxScales_metlt125_geq1j = {
//   1.0,1.0,1.0,18.6572,1.3998,5.4080,2.7796,1.5091,2.0915,1.8487,1.9690,1.5181,1.5919,1.5332,1.5151,1.4429,1.4847,1.3056,1.2793,1.3042,1.2634,1.1890,1.1548,1.1393,1.1217,1.1124,1.1199,1.0824,1.0419,1.0068,0.9891,0.9718,0.9739,0.9094,0.9403,0.9124,0.8714,0.8521,0.8563,0.8261,0.8147,0.7727,0.7631,0.7548,0.7305,0.7223,0.7133,0.6881,0.7691,0.6349,0.6462,0.6298,0.6487,0.5268,0.6609,0.7326,0.7731,0.5102,0.6261,0.6299,0.6485,0.5021,0.8824,0.7793,0.6905,0.5245,0.4707,0.4986,0.1615,0.4255,0.6184,0.4398,0.5,0.6113,0.5,0.0582,0.2885,0.0812,1.0,0.0987
// };

const vector<float> nvtxScales_metlt125_geq1j_skim2l = {
  1.0,1.0,11.474,2.093,1.683,2.393,2.490,2.240,2.013,2.070,1.860,1.960,2.027,1.759,1.680,1.604,1.652,1.576,1.424,1.420,1.342,1.263,1.193,1.168,1.101,1.046,0.977,0.955,0.927,0.883,0.836,0.821,0.779,0.709,0.700,0.706,0.674,0.652,0.620,0.538,0.542,0.552,0.519,0.527,0.500,0.474,0.468,0.467,0.430,0.407,0.385,0.360,0.393,0.286,0.339,0.511,0.355,0.320,0.238,0.481,0.377,0.144,0.451,0.273,0.290,0.145,0.142,0.458,0.264,0.165,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.176,
};



/// skimsamp scales

}

#endif  // HZZLOOPER_UTILITIES_H
